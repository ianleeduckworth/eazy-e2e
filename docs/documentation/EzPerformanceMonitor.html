<head>
    <title>EzPerformanceMonitor</title>
</head>
<link rel="stylesheet" href="../main.css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato" type="text/css">
<ul class="topnav">
    <li class="topnav"><a class="topnav" href="../about/about.html">About</a></li>
    <li class="topnav"><a class="topnav" href="../contact/contact.html">Contact</a></li>
    <li class="topnav topnav-active"><a class ="topnav" href="../documentation/documentation.html">Documentation</a></li>
    <li class="topnav"><a class="topnav" href="../gettingStarted/gettingStarted.html">Getting Started</a></li>
    <li class="topnav"><a class="topnav" href="../../index.html">Home</a></li>
    <li><a class="home-text" href="./index.html">EazyE2E</a></li>
</ul>
<ul class="left-nav">
    <li><a href="./EzElement.html">EzElement</a></li>
    <li><a href="./EzGrid.html">EzGrid</a></li>
    <li><a href="./EzGridItem.html">EzGridItem</a></li>
    <li><a href="./EzList.html">EzList</a></li>
    <li><a href="./EzListItem.html">EzListItem</a></li>
    <li><a href="./EzRootElement.html">EzRootElement</a></li>
    <li><a href="./EzText.html">EzText</a></li>
    <li><a href="./EzKeyboardFunctions.html">EzKeyboardFunctions</a></li>
    <li><a href="./EzMouseFunctions.html">EzMouseFunctions</a></li>
    <li><a href="./EzLogMonitor.html">EzLogMonitor</a></li>
    <li><a href="./EzLongSearch.html">EzLongSearch</a></li>
    <li class="leftnav-active"><a href="./EzPerformanceMonitor.html">EzPerformanceMonitor</a></li>
    <li><a href="./EzProcess.html">EzProcess</a></li>
    <li><a href="./configuration.html">Configuration</a></li>
</ul>

<div class="main-documentation">
    <h1>EzPerformanceMonitor</h1>
    <h5>EzPerformanceMonitor provides a series of properties representing various memory metrics of the application under test.  Additionally it provides methods that allow the
        user to watch the application's memory to make sure that the various memory metrics are within a proper range.  Be sure to check out the
        <a href="#samplesAndUsage">Samples and Usage</a> section at the bottom.
    </h5>
    <h2>Syntax</h2>
    <pre>
        <span class="reserved">public class</span> EzLogMonitor</pre>
    <h2>Constructors</h2>
    <table style="width: 100%">
        <tr>
            <th>Name</th>
            <th>Input</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>EzPerformanceMonitor(EzProcess process)</td>
            <td>EzProcess</td>
            <td>Creates a new instance of EzPerformanceMonitor based on an instance of EzProcess</td>
        </tr>
    </table>
    <h2>Properties</h2>
    <table style="width: 100%">
        <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>NonPagedSystemMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.nonpagedsystemmemorysize64(v=vs.110).aspx" target="_blank">NonPagedSystemMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>PagedMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PagedMemorySize64(v=vs.110).aspx" target="_blank">PagedMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>PagedSystemMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PagedSystemMemorySize64(v=vs.110).aspx" target="_blank">PagedSystemMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>PeakPagedMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PeakPagedMemorySize64(v=vs.110).aspx" target="_blank">PeakPagedMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>PeakVirtualMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PeakVirtualMemorySize64(v=vs.110).aspx" target="_blank">PeakVirtualMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>PeakWorkingSet</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PeakWorkingSet64(v=vs.110).aspx" target="_blank">PeakWorkingSet64</a> here</td>
        </tr>
        <tr>
            <td>PrivateMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.PrivateMemorySize64(v=vs.110).aspx" target="_blank">PrivateMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>VirtualMemorySize</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.VirtualMemorySize64(v=vs.110).aspx" target="_blank">VirtualMemorySize64</a> here</td>
        </tr>
        <tr>
            <td>WorkingSet</td>
            <td>long</td>
            <td>See documentation for <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.process.WorkingSet64(v=vs.110).aspx" target="_blank">WorkingSet64</a> here</td>
        </tr>
    </table>
    <h2>Methods</h2>
    <table style="width: 100%">
        <tr>
            <th>Name</th>
            <th>Return Type</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>StartSyncWatch(MemoryType type, long amount, int timeInSeconds, IfFail ifFail, SingularSuccess ifSuccess)</td>
            <td>void</td>
            <td>Performs a sync watch on a specific memory type.  If that memory type exceeds the threshold at any point during the monitoring period, the ifFail delegate will be called.  Otherwise, the ifSuccess delegate will be called</td>
        </tr>
        <tr>
            <td>StartSyncWatch(IEnumerable&lt;MemoryWatch&gt; watches, int timeInSeconds, IfFail ifFail, MultiSuccess ifSuccess)</td>
            <td>void</td>
            <td>Performs a sync watch on a series of memory types.  If that any of the memory types exceed the threshold at any point during the monitoring period, the ifFail delegate will be called.  Otherwise, the ifSuccess delegate will be called</td>
        </tr>
    </table>
    <a class="anchor" id="samplesAndUsage"></a>
    <h2>Samples and Usage</h2>
    <p>EzPerformanceMonitor is designed to watch various memory metrics via two methods, both called StartSyncWatch (one takes a single memory metric and one takes multiple).  They
        will both monitor the application for the duration of the time passed in and will call an ifSuccess delegate if the memory metric(s) never exceed the passed in threshold.  If
        any of the memory metrics exceed their threshold, the ifFail delegate will be called
    </p>
    <pre>
        <span class="reserved">const string</span> calculatorPath = <span class="string">"C:\\Windows\\System32\\calculator.exe"</span>;
        <span class="reserved">using</span> (<span class="class-name">EzProcess</span> process = <span class="reserved">new</span> <span class="class-name">EzProcess</span>(calculatorPath, <span class="string">"Calculator"</span>))
        {
            process.StartProcess();

            <span class="class-name">EzPerformanceMonitor</span> performanceMonitor = <span class="reserved">new</span> <span class="class-name">EzPerformanceMonitor</span>(process);

            <span class="comment">//Create a list of watches.  These are the memory metrics we will be watching for to make sure they don't</span>
            <span class="comment">//exceed the amount given for each</span>
            <span class="class-name">List</span>&lt;<span class="class-name">MemoryWatch</span>&gt; watches = <span class="reserved">new</span> <span class="class-name">List</span>&lt;<span class="class-name">MemoryWatch</span>&gt;
            {
                <span class="reserved">new</span> <span class="class-name">MemoryWatch</span>(<span class="class-name">MemoryType</span>.PagedMemorySize, 100000000),
                <span class="reserved">new</span> <span class="class-name">MemoryWatch</span>(<span class="class-name">MemoryType</span>.PeakVirtualMemorySize, 200000000),
                <span class="reserved">new</span> <span class="class-name">MemoryWatch</span>(<span class="class-name">MemoryType</span>.VirtualMemorySize, 203040506060)
            };

            <span class="comment">//Call the StartSyncWatch method.  We will watch based on the list above for 60 seconds</span>
            performanceMonitor.StartSyncWatch(watches, 60, (type, original, actual, failure) =>
            {
                <span class="comment">//Method to be run if a failure occurs</span>
                <span class="class-name">Console</span>.WriteLine(<span class="string">$"Memory type </span>{type}<span class="string"> exceeded the threshhold of </span>{original}<span class="string">.  "</span> +
                    <span class="string">"Value: </span>{actual}<span class="string">.  Time at failure: </span>{failure}<span class="string">."</span>);
            }, (memWatches, time) =>
            {
                <span class="comment">//Method to run if no failure occurs</span>
                <span class="reserved">string</span> watchesString = memWatches.Select(x => x.Type.ToString()).Aggregate((a, b) => a + <span class="string">", "</span>);
                <span class="class-name">Console</span>.WriteLine(<span class="string">$"After </span>{time}<span class="string"> seconds of profiling, no memory types exceeded their limits."</span> + 
                <span class="string">$"Memory types: </span>{watchesString}<span class="string">."</span>);
            });
        }</pre>
</div>
